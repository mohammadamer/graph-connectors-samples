[
  {
    "id": "overview",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Microsoft Graph overview\"\r\ndescription: \"Use Microsoft Graph data and other datasets to derive insights and analytics, extend Microsoft 365 experiences, and build unique, intelligent apps.\"\r\nauthor: \"angelgolfer-ms\"\r\nms.localizationpriority: high\r\nms.custom: scenarios:getting-started\r\n---\r\n\r\n# Overview of Microsoft Graph\r\n\r\nMicrosoft Graph is the gateway to data and intelligence in Microsoft 365. It provides a unified programmability model that you can use to access the tremendous amount of data in Microsoft 365, Windows, and Enterprise Mobility + Security. Use the wealth of data in Microsoft Graph to build apps for organizations and consumers that interact with millions of users.\r\n\r\n![Microsoft Graph, Microsoft Graph Data Connect, and Microsoft Graph connectors enable extending Microsoft 365 experiences and building intelligent apps.](images/microsoft-graph-dataconnect-connectors-enhance.png)\r\n\r\n## Data and services powering the Microsoft 365 platform\r\n\r\nIn the Microsoft 365 platform, three main components facilitate the access and flow of data:\r\n\r\n- The **Microsoft Graph API** offers a single endpoint, `https://graph.microsoft.com`, to provide access to rich, people-centric data and insights in the Microsoft cloud, including Microsoft 365, Windows, and Enterprise Mobility + Security. You can use REST APIs or SDKs to access the endpoint and build apps that support Microsoft 365 scenarios, spanning across productivity, collaboration, education, people and workplace intelligence, and more. Microsoft Graph also includes a powerful set of services that manage user and device identity, access, compliance, and security and help protect organizations from data leakage or loss.\r\n- **[Microsoft Graph connectors](#bring-data-from-an-external-content-source-to-microsoft-graph)** work in the incoming direction, delivering data external to the Microsoft cloud into Microsoft Graph services and applications to enhance Microsoft 365 experiences such as Microsoft Search. Connectors exist for many commonly used data sources such as Box, Google Drive, Jira, and Salesforce.\r\n- **[Microsoft Graph Data Connect](#access-microsoft-graph-data-at-scale)** provides a set of tools to streamline secure and scalable delivery of Microsoft Graph data to popular Azure data stores. The cached data serves as data sources for Azure development tools that you can use to build intelligent applications.\r\n\r\nTogether, the Microsoft Graph API, connectors, and Data Connect power the Microsoft 365 platform. With the ability to access Microsoft Graph data and other datasets, you can derive insights and analytics, extend Microsoft 365 experiences, and build unique, intelligent applications.\r\n\r\n## What's in Microsoft Graph?\r\n\r\nMicrosoft Graph exposes REST APIs and client libraries to access data on the following Microsoft cloud services:\r\n\r\n- **Microsoft 365 core services:** Bookings, Calendar, Delve, Excel, Microsoft 365 compliance eDiscovery, Microsoft Search, OneDrive, OneNote, Outlook/Exchange, People (Outlook contacts), Planner, SharePoint, Teams, To Do, Viva Insights\r\n- **Enterprise Mobility + Security services:** Advanced Threat Analytics, Advanced Threat Protection, Azure Active Directory, Identity Manager, and Intune\r\n- **Windows services:** activities, devices, notifications, Universal Print\r\n- **Dynamics 365 Business Central services**\r\n\r\nTo find out more, see [Major services and features in Microsoft Graph](overview-major-services.md).\r\n\r\n![An image showing the primary resources and relationships that are part of Microsoft Graph](images/microsoft-graph.png)\r\n\r\n## What can you do with Microsoft Graph?\r\n\r\n> [!VIDEO https://www.youtube-nocookie.com/embed/PI9NO5rayiY]\r\n\r\nUse Microsoft Graph to build experiences around the user's unique context to help them be more productive. Imagine an app that...\r\n\r\n- Looks at your next meeting and helps you prepare for it by providing profile information for attendees, including their job titles and managers, as well as information about the latest documents they're working on, and people they're collaborating with.\r\n- Scans your calendar, and suggests the best times for the next team meeting.\r\n- Fetches the latest sales projection chart from an Excel file in your OneDrive and lets you update the forecast in real time, all from your phone.\r\n- Subscribes to changes in your calendar, sends you an alert when you're spending too much time in meetings, and provides recommendations for the ones you can miss or delegate based on how relevant the attendees are to you.\r\n- Helps you sort out personal and work information on your phone; for example, by categorizing pictures that should go to your personal OneDrive and business receipts that should go to your OneDrive for Business.\r\n- Analyzes at-scale Microsoft 365 data so that decision makers can unlock valuable insights into time allocation and collaboration patterns that improve business productivity.\r\n- Brings custom business data into Microsoft Graph, indexing it to make it searchable along with data from Microsoft 365 services.\r\n\r\nPick the first scenario about researching meeting attendees as an example. With the Microsoft Graph API, you can:\r\n\r\n1. Get the email addresses of the [meeting event](/graph/api/resources/event) attendees.\r\n2. Look them up individually as a [user](/graph/api/resources/user) in Azure Active Directory to [get their profile information](/graph/api/user-get).\r\n\r\nYou can then navigate to other resources using relationships:\r\n\r\n- Connect to their manager through a [manager relationship](/graph/api/user-list-manager).\r\n- Get valuable insights and intelligence including the popular files [trending around](/graph/api/resources/insights-trending) the user.\r\n- [Get the most relevant people](/graph/api/user-list-people?view=graph-rest-beta&preserve-view=true) around the user.\r\n- Extend the scenario to get to the user's groups through a [memberOf](/graph/api/user-list-memberof) relationship.\r\n- [Reach other members in each group](/graph/api/group-list-members).\r\n- Tap into other scenarios enabled by [groups](microsoft365-groups-concept-overview.md), such as [education](education-concept-overview.md) and [teamwork](teams-concept-overview.md).\r\n\r\nMicrosoft Graph continues to open up the Microsoft 365 platform for developers, and always only with the appropriate permissions.\r\n\r\n> [!NOTE]\r\n> When you use the Microsoft Graph API, you agree to the [Microsoft APIs Terms of Use](/legal/microsoft-apis/terms-of-use?context=/graph/context) and the [Microsoft Privacy Statement](https://go.microsoft.com/fwlink/?LinkId=521839).\r\n\r\n### Popular API requests\r\n\r\nCheck out some of these common scenarios for working with the Microsoft Graph API. The links take you to the [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).\r\n\r\n| **Operation** | **URL** |\r\n|:--------------------------|:----------------------------------------|\r\n|   GET my profile | [`https://graph.microsoft.com/v1.0/me`](https://developer.microsoft.com/graph/graph-explorer/?request=me&version=v1.0) |\r\n|   GET my files | [`https://graph.microsoft.com/v1.0/me/drive/root/children`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fdrive%2Froot%2Fchildren&version=v1.0) |\r\n|   GET my photo | [`https://graph.microsoft.com/v1.0/me/photo/$value`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fphoto%2F%24value&version=v1.0) |\r\n|   GET my mail | [`https://graph.microsoft.com/v1.0/me/messages`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fmessages&version=v1.0) |\r\n|   GET my high importance email | [`https://graph.microsoft.com/v1.0/me/messages?$filter=importance%20eq%20'high'`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fmessages%3F%24filter%3Dimportance%2520eq%2520'high'&version=v1.0) |\r\n|   GET my calendar events | [`https://graph.microsoft.com/v1.0/me/events`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fevents&version=v1.0) |\r\n|   GET my manager | [`https://graph.microsoft.com/v1.0/me/manager`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fmanager&version=v1.0) |\r\n|   GET last user to modify file foo.txt | [`https://graph.microsoft.com/v1.0/me/drive/root/children/foo.txt/lastModifiedByUser`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fdrive%2Froot%2Fchildren%2Ffoo.txt%2FlastModifiedByUser&version=v1.0) |\r\n|   GET Microsoft 365 groups I'm a member of| [`https://graph.microsoft.com/v1.0/me/memberOf/$/microsoft.graph.group?$filter=groupTypes/any(a:a%20eq%20'unified')`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2FmemberOf%2F%24%2Fmicrosoft.graph.group%3F%24filter%3DgroupTypes%2Fany(a%3Aa%2520eq%2520'unified')&version=v1.0) |\r\n|   GET users in my organization  | [`https://graph.microsoft.com/v1.0/users`](https://developer.microsoft.com/graph/graph-explorer/?request=users&version=v1.0) |\r\n|   GET groups in my organization | [`https://graph.microsoft.com/v1.0/groups`](https://developer.microsoft.com/graph/graph-explorer/?request=groups&version=v1.0) |\r\n|   GET people related to me | [`https://graph.microsoft.com/v1.0/me/people`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fpeople&version=beta)  |\r\n|   GET items trending around me | [`https://graph.microsoft.com/beta/me/insights/trending`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Finsights%2Ftrending&version=v1.0) |\r\n|   GET my notes | [`https://graph.microsoft.com/v1.0/me/onenote/notebooks`](https://developer.microsoft.com/graph/graph-explorer/?request=me%2Fonenote%2Fnotebooks&version=beta) |\r\n\r\n## Bring data from an external content source to Microsoft Graph\r\n\r\nUse [Microsoft Graph connectors](connecting-external-content-connectors-overview.md) to bring data that is external to the Microsoft cloud into Microsoft Graph. Examples of such data can be an organization's human resources database or product catalog, hosted on-premises or in the public or private clouds.\r\n\r\nMicrosoft Graph connectors create connections to external data sources, index the data, and store it as external custom items and files. Once indexed, those items can show up in Microsoft Search and for apps that use the [Microsoft Search API](search-concept-overview.md).\r\n\r\n## Access Microsoft Graph data at scale\r\n\r\nUse [Microsoft Graph Data Connect](data-connect-concept-overview.md) to access data on Microsoft Graph at scale, while allowing administrators granular consent and full control over their Microsoft Graph data. Data Connect streamlines the delivery of this data to Microsoft Azure.\r\n\r\nUsing Azure tools, you can then build intelligent apps that:\r\n\r\n- Find you the closest expert on a topic to you in your organization.\r\n- Automate knowledge base creation.\r\n- Analyze meeting requests to provide insights into conference room utilization.\r\n- Detect fraud with productivity and communication data.\r\n\r\n## When should I use Microsoft Graph API or Data Connect?\r\n\r\nMicrosoft Graph Data Connect provides a new way for you to interact with the data that's available through Microsoft Graph APIs. Data Connect provides a unique set of tools that streamline the building of intelligent applications, all within the Microsoft cloud.\r\n\r\n|**Feature**| **Microsoft Graph API** | **Microsoft Graph Data Connect** |\r\n|:----------|:------------------------|:--------------------------------------|\r\n| **Access scope** | Single user or entire tenant | Many users or groups |\r\n| **Access pattern** | Real time | Recurrent schedule |\r\n| **Data operations** | Operates on data master | Operates on a cache of the data |\r\n| **Data protection** | Data is protected while in Microsoft 365 | Data protection is extended to the cache of data in your Azure subscription |\r\n| **User consent** | Self<br>Resource types | None |\r\n| **Admin consent** | Entire organization<br>Resource types | Select groups of users<br>Resource types and properties<br>Excludes users |\r\n| **Access tools** | RESTful web queries | Azure Data Factory |\r\n\r\n## Next steps\r\n\r\n- Check out some [partner solutions](https://developer.microsoft.com/graph/partners).\r\n- Try a sample request in the [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).\r\n- Use the [quick start](https://developer.microsoft.com/graph/quick-start) to set up a ready-to-run sample app.\r\n- Look under **Learn** in the table of contents to read about services and features that you can use in your scenarios.\r\n- Learn about [metered APIs and services in Microsoft Graph](metered-api-overview.md).\r\n- Find out how to [get an auth token](auth/auth-concepts.md) in your app.\r\n- Start [using the API](use-the-api.md).\r\n"
  },
  {
    "id": "traverse-the-graph",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Access data and methods by navigating Microsoft Graph\"\r\ndescription: \"In addition to using the Microsoft Graph API to read and write data, you can use a number of request patterns to traverse through the resources in Microsoft Graph. The metadata document also helps you to understand the data model of the resources and relationships in Microsoft Graph.\"\r\nms.localizationpriority: high\r\nms.custom: graphiamtop20, scenarios:getting-started\r\n---\r\n\r\n# Access data and methods by navigating Microsoft Graph\r\n\r\nIn addition to using the Microsoft Graph API to read and write data, you can use a number of request patterns to traverse through the resources in Microsoft Graph. The metadata document also helps you to understand the data model of the resources and relationships in Microsoft Graph.\r\n\r\n## Microsoft Graph API metadata\r\n\r\nThe metadata document ($metadata) is published at the service root. You can view the service document for the v1.0 and beta versions of the Microsoft Graph API via the following URLs.\r\n\r\n**Microsoft Graph API v1.0 metadata**\r\n\r\n```msgraph-interactive\r\nhttps://graph.microsoft.com/v1.0/$metadata\r\n```\r\n\r\n**Microsoft Graph API beta metadata**\r\n\r\n```msgraph-interactive\r\nhttps://graph.microsoft.com/beta/$metadata\r\n```\r\n\r\nThe metadata allows you to see and understand the Microsoft Graph data model, including the entity types, complex types, and enumerations that make up the resources represented in the request and response packets. \r\n\r\nThe metadata also supports defining types, methods, and enumerations in corresponding OData namespaces. The majority of the Microsoft Graph API is defined in the OData namespace, `microsoft.graph`. A few APIs are defined in subnamespaces, for example, `microsoft.graph.callRecords`.\r\n\r\nYou can use the metadata to learn the relationships between entities in Microsoft Graph and establish URLs that navigate between those entities.\r\n\r\n> [!NOTE]\r\n> - Use resource IDs in the same case as they are returned from Microsoft Graph APIs.\r\n> - Assume resource IDs, values you assign, and other base-64-encoded values are _case-sensitive_.\r\n> - Assume path URL resource names, query parameters, action and function names, their request body parameters, including any API property names and values, are _not case-sensitive_.\r\n\r\n## View a collection of resources\r\n\r\nMicrosoft Graph lets you view resources in a tenant using HTTP `GET` queries. The query response includes properties of each resource. Entity resources are each identified by its ID. The format of a resource ID generally varies according to the resource type.\r\n\r\nFor example, you can get the collection of [user](/graph/api/resources/user) resources defined in a tenant:\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/users HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/users' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q'\r\n```\r\n\r\n---\r\n\r\nIf successful, you'll get a 200 OK response that contains the collection of **user** resources in the payload. Each user is\r\nidentified by the **id** property and accompanied by its default properties. The payload shown below is truncated for brevity.\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\nContent-type: application/json\r\n\r\n{\r\n  \"@odata.context\":\"https://graph.microsoft.com/v1.0/$metadata#users\",\r\n  \"value\":[\r\n    {\r\n      \"id\":\"f71f1f74-bf1f-4e6b-b266-c777ea76e2c7\",\r\n      \"businessPhones\":[\r\n\r\n      ],\r\n      \"displayName\":\"CIE Administrator\",\r\n      \"givenName\":\"CIE\",\r\n      \"jobTitle\":null,\r\n      \"mail\":\"admin@contoso.onmicrosoft.com\",\r\n      \"mobilePhone\":\"+1 3528700812\",\r\n      \"officeLocation\":null,\r\n      \"preferredLanguage\":\"en-US\",\r\n      \"surname\":\"Administrator\",\r\n      \"userPrincipalName\":\"admin@contoso.onmicrosoft.com\"\r\n    },\r\n    {\r\n      \"id\":\"d66f2902-9d12-4ff8-ab01-21ec6706079f\",\r\n      \"businessPhones\":[\r\n\r\n      ],\r\n      \"displayName\":\"Alan Steiner\",\r\n      \"givenName\":\"Alan\",\r\n      \"jobTitle\":\"VP Corporate Marketing\",\r\n      \"mail\":\"alans@contoso.onmicrosoft.com\",\r\n      \"mobilePhone\":null,\r\n      \"officeLocation\":null,\r\n      \"preferredLanguage\":\"en-US\",\r\n      \"surname\":\"Steiner\",\r\n      \"userPrincipalName\":\"alans@contoso.onmicrosoft.com\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nMicrosoft Graph also lets you view collections by navigating the relationships of one resource with another. For example, through a user's **mailFolders** navigation property,\r\nyou can query for the collection of [mailFolder](/graph/api/resources/mailfolder) resources in the user's mailbox:\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/me/mailfolders HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/me/mailFolders' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \r\n```\r\n\r\n---\r\n\r\nIf successful, you'll get a 200 OK response that contains the collection of [mailFolder](/graph/api/resources/user) resources in the payload. Each **mailFolder** is\r\nidentified by the **id** property and accompanied by its properties. The payload shown below is truncated for brevity.\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\nContent-type: application/json\r\n\r\n{\r\n  \"@odata.context\":\"https://graph.microsoft.com/v1.0/$metadata#users('16f5a7b6-5a15-4568-aa5a-31bb117e9967')/mailFolders\",\r\n  \"value\":[\r\n    {\r\n      \"id\":\"AAMkADRm9AABDGisXAAA=\",\r\n      \"displayName\":\"Archive\",\r\n      \"parentFolderId\":\"AQMkADRmZWj0AAAIBCAAAAA==\",\r\n      \"childFolderCount\":0,\r\n      \"unreadItemCount\":0,\r\n      \"totalItemCount\":0\r\n    },\r\n    {\r\n      \"id\":\"AQMkADRm0AAAIBXAAAAA==\",\r\n      \"displayName\":\"Sales reports\",\r\n      \"parentFolderId\":\"AQMkADRmZWj0AAAIBCAAAAA==\",\r\n      \"childFolderCount\":0,\r\n      \"unreadItemCount\":0,\r\n      \"totalItemCount\":0\r\n    },\r\n    {\r\n      \"id\":\"AAMkADRCxI9AAAT6CAIAAA=\",\r\n      \"displayName\":\"Conversation History\",\r\n      \"parentFolderId\":\"AQMkADRmZWj0AAAIBCAAAAA==\",\r\n      \"childFolderCount\":1,\r\n      \"unreadItemCount\":0,\r\n      \"totalItemCount\":0\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n## View a specific resource from a collection by ID\r\n\r\nContinuing with using **user** as an example - to view the information about a user, use an HTTPS GET request to get a specific user by the user's ID. For a **user** entity, you can use either the **id** or **userPrincipalName** property as the identifier.\r\n\r\nThe following request example uses the **userPrincipalName** value as the user's ID.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q'\r\n```\r\n\r\n---\r\n\r\nIf successful, you'll get a 200 OK response that contains the user resource representation in the payload, as shown.\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\ncontent-type: application/json;odata.metadata=minimal\r\ncontent-length: 982\r\n\r\n{\r\n    \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users/$entity\",\r\n    \"id\": \"c95e3b3a-c33b-48da-a6e9-eb101e8a4205\",\r\n    \"city\": \"Redmond\",\r\n    \"country\": \"USA\",\r\n    \"department\": \"Help Center\",\r\n    \"displayName\": \"John Doe\",\r\n    \"givenName\": \"John\",\r\n    \"userPrincipalName\": \"john.doe@contoso.onmicrosoft.com\",\r\n\r\n    ...\r\n}\r\n```\r\n\r\n## Read specific properties of a resource\r\nTo retrieve only the user's biographical data, such as the user's provided _About me_ description and their skill set, you can add the [$select](query-parameters.md) query parameter to the previous request, as shown in the following example.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com?$select=displayName,aboutMe,skills HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com?%24select=displayName%2CaboutMe%2Cskills' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \r\n```\r\n\r\n---\r\n\r\nThe successful response returns the 200 OK status and a payload, as shown.\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\ncontent-type: application/json;odata.metadata=minimal\r\ncontent-length: 169\r\n\r\n{\r\n    \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users/$entity\",\r\n    \"aboutMe\": \"A cool and nice guy.\",\r\n    \"displayName\": \"John Doe\",\r\n    \"skills\": [\r\n        \"n-Lingual\",\r\n        \"public speaking\",\r\n        \"doodling\"\r\n    ]\r\n}\r\n```\r\n\r\nHere, instead of the entire property sets on the **user** entity, only the **aboutMe**, **displayName**, and **skills** basic properties are returned.\r\n\r\nWhen you make a GET request without using `$select` to limit the amount of properties data, Microsoft Graph includes a **@microsoft.graph.tips** property that provides a best practice recommendation for using `$select` similar to the following message:\r\n\r\n```html\r\n\"@microsoft.graph.tips\": \"Use $select to choose only the properties your app needs, as this can lead to performance improvements. For example: GET groups?$select=appMetadata,assignedLabels\",\r\n```\r\n\r\n## Read specific properties of the resources in a collection\r\nIn addition to reading specific properties of a single resource, you can also apply the similar [$select](query-parameters.md) query parameter to a collection to get back all resources in the collection with just the specific properties returned on each.\r\n\r\nFor example, to query the name of the signed-in user's drive items, you can submit the following HTTPS GET request.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/me/drive/root/children?$select=name HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/me/drive/root/children?%24select=name' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \r\n```\r\n\r\n---\r\n\r\nThe successful response returns a 200 OK status code and a payload that contains only the names of the shared files, as shown in the following example.\r\n\r\n```json\r\n{\r\n  \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users('john.doe%40contoso.onmicrosoft.com')/drive/root/children(name,type)\",\r\n  \"value\": [\r\n    {\r\n      \"@odata.etag\": \"\\\"{896A8E4D-27BF-424B-A0DA-F073AE6570E2},2\\\"\",\r\n      \"name\": \"Shared with Everyone\"\r\n    },\r\n    {\r\n      \"@odata.etag\": \"\\\"{B39D5D2E-E968-491A-B0EB-D5D0431CB423},1\\\"\",\r\n      \"name\": \"Documents\"\r\n    },\r\n    {\r\n      \"@odata.etag\": \"\\\"{9B51EA38-3EE6-4DC1-96A6-230E325EF054},2\\\"\",\r\n      \"name\": \"newFile.txt\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n## Traverse from one resource to another via relationship\r\nA manager holds a **directReports** relationship with the other users reporting to him or her.\r\nTo query the list of the direct reports of a user, you can use the following HTTPS GET request to navigate to the intended target via relationship traversal.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com/directReports HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/users/john.doe@contoso.onmicrosoft.com/directReports' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \r\n```\r\n\r\n---\r\n\r\nThe successful response returns the 200 OK status and a payload, as shown.\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\ncontent-type: application/json;odata.metadata=minimal\r\ncontent-length: 152\r\n\r\n{\r\n    \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#directoryObjects/$entity\",\r\n    \"@odata.type\": \"#microsoft.graph.user\",\r\n    \"id\": \"c37b074d-fe9d-4e68-83ad-b4401d3be174\",\r\n    \"department\": \"Sales & Marketing\",\r\n    \"displayName\": \"Bonnie Kearney\",\r\n\r\n    ...\r\n}\r\n```\r\n\r\nSimilarly, you can follow a relationship to navigate to related resources.\r\nFor example, the user-messages relationship enables traversal from an Azure Active Directory (Azure AD) User to a set of Outlook mail messages.\r\nThe following example shows how to do this in a REST API call.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nGET https://graph.microsoft.com/v1.0/me/messages HTTP/1.1\r\nAuthorization : Bearer {access_token}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request GET 'https://graph.microsoft.com/v1.0/me/messages' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \r\n```\r\n\r\n---\r\n\r\nThe successful response returns the 200 OK status and a payload, as shown.\r\n\r\n\r\n```json\r\nHTTP/1.1 200 OK\r\ncontent-type: application/json;odata.metadata=minimal\r\nodata-version: 4.0\r\ncontent-length: 147\r\n\r\n{\r\n  \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#users('john.doe%40contoso.onmicrosoft.com')/Messages\",\r\n  \"@odata.nextLink\": \"https://graph.microsoft.com/v1.0/me/messages?$top=1&$skip=1\",\r\n  \"value\": [\r\n    {\r\n      \"@odata.etag\": \"W/\\\"FwAAABYAAABMR67yw0CmT4x0kVgQUH/3AAJL+Kej\\\"\",\r\n      \"id\": \"<id-value>\",\r\n      \"createdDateTime\": \"2015-11-14T00:24:42Z\",\r\n      \"lastModifiedDateTime\": \"2015-11-14T00:24:42Z\",\r\n      \"changeKey\": \"FwAAABYAAABMR67yw0CmT4x0kVgQUH/3AAJL+Kej\",\r\n      \"categories\": [],\r\n      \"receivedDateTime\": \"2015-11-14T00:24:42Z\",\r\n      \"sentDateTime\": \"2015-11-14T00:24:28Z\",\r\n      \"hasAttachments\": false,\r\n      \"subject\": \"Did you see last night's game?\",\r\n      \"body\": {\r\n        \"ContentType\": \"HTML\",\r\n        \"Content\": \"<content>\"\r\n      },\r\n      \"BodyPreview\": \"it was great!\",\r\n      \"Importance\": \"Normal\",\r\n\r\n       ...\r\n    }\r\n  ]\r\n}\r\n```\r\nYou can see all the relationships on a given resource by going to the metadata, finding the `EntityType`, and looking at each `NavigationProperty` for that `EntityType`.\r\n\r\n## Call actions and functions\r\nMicrosoft Graph also supports _actions_ and _functions_ to manipulate resources in ways that are not simply create, read, update, and delete (CRUD) operations. They are often in the shape of HTTPS POST requests in order to intake arguments for the action or function. For example, the following action lets the signed-in user (`me`) send an email message.\r\n\r\n# [HTTP](#tab/http)\r\n```http\r\nPOST https://graph.microsoft.com/v1.0/me/sendMail HTTP/1.1\r\nauthorization: bearer {access_token}\r\ncontent-type: application/json\r\ncontent-length: 96\r\n\r\n{\r\n  \"message\": {\r\n    \"subject\": \"Meet for lunch?\",\r\n    \"body\": {\r\n      \"contentType\": \"Text\",\r\n      \"content\": \"The new cafeteria is open.\"\r\n    },\r\n    \"toRecipients\": [\r\n      {\r\n        \"emailAddress\": {\r\n          \"address\": \"garthf@contoso.onmicrosoft.com\"\r\n        }\r\n      }\r\n    ],\r\n    \"attachments\": [\r\n      {\r\n        \"@odata.type\": \"microsoft.graph.fileAttachment\",\r\n        \"name\": \"menu.txt\",\r\n        \"contentBytes\": \"bWFjIGFuZCBjaGVlc2UgdG9kYXk=\"\r\n      }\r\n    ]\r\n  },\r\n  \"saveToSentItems\": \"false\"\r\n}\r\n```\r\n\r\n# [cURL](#tab/curl)\r\n```bash\r\ncurl --location --request POST 'https://graph.microsoft.com/v1.0/me/sendMail' \\\r\n--header 'Content-Type: application/json' \\\r\n--header 'Authorization: Bearer eyJ0eXAiOiJKV1Qi...8Q18N8vSgrd0Q' \\\r\n--data-raw '{\r\n  \"message\": {\r\n    \"subject\": \"Meet for lunch?\",\r\n    \"body\": {\r\n      \"contentType\": \"Text\",\r\n      \"content\": \"The new cafeteria is open.\"\r\n    },\r\n    \"toRecipients\": [\r\n      {\r\n        \"emailAddress\": {\r\n          \"address\": \"garthf@contoso.onmicrosoft.com\"\r\n        }\r\n      }\r\n    ],\r\n    \"attachments\": [\r\n      {\r\n        \"@odata.type\": \"microsoft.graph.fileAttachment\",\r\n        \"name\": \"menu.txt\",\r\n        \"contentBytes\": \"bWFjIGFuZCBjaGVlc2UgdG9kYXk=\"\r\n      }\r\n    ]\r\n  },\r\n  \"saveToSentItems\": \"false\"\r\n}'\r\n```\r\n\r\n---\r\n\r\nYou can see all the functions that are available in the metadata. They appear as Functions or Actions.\r\n\r\n## Use the Microsoft Graph SDKs\r\n\r\nLike the power and ease of SDKs? While you can always use REST APIs to call Microsoft Graph, we also provide SDKs for many popular platforms. To explore the SDKs that are available, see [Code samples and SDKs](https://developer.microsoft.com/graph/code-samples-and-sdks).\r\n\r\n## See also\r\n\r\n- [Use the Microsoft Graph API](use-the-api.md)\r\n- [Get auth tokens](./auth/index.yml)\r\n"
  },
  {
    "id": "use-the-api",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Use the Microsoft Graph API\"\r\ndescription: \"Learn how to register your app and get authentication tokens for a user or service before you make requests to the Microsoft Graph API.\"\r\nms.localizationpriority: high\r\nms.custom: graphiamtop20, scenarios:getting-started\r\n---\r\n\r\n# Use the Microsoft Graph API\r\n\r\nMicrosoft Graph is a RESTful web API that enables you to access Microsoft Cloud service resources. After you [register your app](auth-register-app-v2.md) and [get authentication tokens for a user](auth-v2-user.md) or [service](auth-v2-service.md), you can make requests to the Microsoft Graph API.\r\n\r\n> [!IMPORTANT]\r\n> How conditional access policies apply to Microsoft Graph is changing. Applications need to be updated to handle scenarios where conditional access policies are configured. For more information and guidance, see [Developer guidance for Azure Active Directory Conditional Access](/azure/active-directory/develop/active-directory-conditional-access-developer).\r\n\r\n## OData namespace\r\n\r\nThe Microsoft Graph API defines most of its resources, methods, and enumerations in the OData namespace, `microsoft.graph`, in the [Microsoft Graph metadata](traverse-the-graph.md#microsoft-graph-api-metadata). A small number of API sets are defined in their sub-namespaces, such as the [call records API](/graph/api/resources/callrecords-api-overview) which defines resources like [callRecord](/graph/api/resources/callrecords-callrecord) in `microsoft.graph.callRecords`. \r\n\r\nUnless explicitly specified in the corresponding topic, assume types, methods, and enumerations are part of the `microsoft.graph` namespace.\r\n\r\n## Call a REST API method\r\n\r\nTo read from or write to a resource such as a user or an email message, you construct a request that looks like the following:\r\n\r\n<!-- {\r\n  \"blockType\": \"ignored\"\r\n}-->\r\n```http\r\n{HTTP method} https://graph.microsoft.com/{version}/{resource}?{query-parameters}\r\n```\r\n\r\nThe components of a request include:\r\n\r\n* [{HTTP method}](#http-methods) - The HTTP method used on the request to Microsoft Graph.\r\n* [{version}](#version) - The version of the Microsoft Graph API your application is using.\r\n* [{resource}](#resource) - The resource in Microsoft Graph that you're referencing. \r\n* [{query-parameters}](#query-parameters) - Optional OData query options or REST method parameters that customize the response.\r\n* [{headers}](#headers) - Request headers that customize the request. Can be optional or required depending on the API.\r\n\r\nAfter you make a request, a response is returned that includes: \r\n\r\n* Status code - An HTTP status code that indicates success or failure. For details about HTTP error codes, see [Errors](errors.md).\r\n* Response message - The data that you requested or the result of the operation. The response message can be empty for some operations.\r\n* `@odata.nextLink` - If your request returns a lot of data, you need to page through it by using the URL returned in `@odata.nextLink`. For details, see [Paging](paging.md).\r\n* Response headers - Additional information about the response, such as the type of content returned and the request-id that you can use to correlate the response to the request.\r\n\r\n## HTTP methods\r\n\r\nMicrosoft Graph uses the HTTP method on your request to determine what your request is doing. Depending on the resource, the API may support operations including actions, functions, or CRUD operations described below.\r\n\r\n|**Method** |**Description**                             |\r\n| :----- | :------------------------------------------- |\r\n| GET    | Read data from a resource.                   |\r\n| POST   | Create a new resource, or perform an action. |\r\n| PATCH  | Update a resource with new values.           |\r\n| PUT    | Replace a resource with a new one.           |\r\n| DELETE | Remove a resource.                           |\r\n\r\n* For the CRUD methods `GET` and `DELETE`, no request body is required.\r\n* The `POST`, `PATCH`, and `PUT` methods require a request body, usually specified in JSON format, that contains additional information, such as the values for properties of the resource.\r\n\r\n> [!IMPORTANT]\r\n> Write requests in the Microsoft Graph API have a size limit of 4 MB. \r\n>\r\n> In some cases, the actual write request size limit is lower than 4 MB. For example, attaching a file to a user event by `POST /me/events/{id}/attachments` has a request size limit of 3 MB, because a file around 3.5 MB can become larger than 4 MB when encoded in base64.\r\n>\r\n> Requests exceeding the size limit fail with the status code HTTP 413, and the error message \"Request entity too large\" or \"Payload too large\".\r\n\r\n## Version\r\n\r\nMicrosoft Graph currently supports two versions: `v1.0` and `beta`.\r\n\r\n* `v1.0` includes generally available APIs. Use the v1.0 version for all production apps.\r\n* `beta` includes APIs that are currently in preview. Because we might introduce breaking changes to our beta APIs, we recommend that you use the beta version only to test apps that are in development; do not use beta APIs in your production apps.\r\n\r\nWe are always looking for feedback on our beta APIs. To provide feedback or request features, see our [Microsoft 365 Developer Platform ideas forum](https://techcommunity.microsoft.com/t5/microsoft-365-developer-platform/idb-p/Microsoft365DeveloperPlatform/label-name/Microsoft%20Graph).\r\n\r\nFor more information about API versions, see [Versioning and support](versioning-and-support.md).\r\n\r\n## Resource\r\n\r\nA resource can be an entity or complex type, commonly defined with properties. Entities differ from complex types by always including an **id** property.\r\n\r\nYour URL will include the resource you are interacting with in the request, such as `me`, **user**, **group**, **drive**, and **site**. Often, top-level resources also include _relationships_, which you can use to access additional resources, like `me/messages` or `me/drive`. You can also interact with resources using _methods_; for example, to send an email, use `me/sendMail`. For more information, see [Access data and methods by navigating Microsoft Graph](traverse-the-graph.md).\r\n\r\nEach resource might require different permissions to access it. You will often need a higher level of permissions to create or update a resource than to read it. For details about required permissions, see the method reference topic. \r\n\r\nFor details about permissions, see [Permissions reference](permissions-reference.md).\r\n\r\n## Query parameters\r\n\r\nQuery parameters can be OData system query options, or other strings that a method accepts to customize its response.\r\n\r\nYou can use optional OData system query options to include more or fewer properties than the default response, filter the response for items that match a custom query, or provide additional parameters for a method.\r\n\r\nFor example, adding the following `filter` parameter restricts the messages returned to only those with the `emailAddress` property of `jon@contoso.com`.\r\n\r\n<!-- {\r\n  \"blockType\": \"ignored\"\r\n}-->\r\n```http\r\nGET https://graph.microsoft.com/v1.0/me/messages?filter=emailAddress eq 'jon@contoso.com'\r\n```\r\n\r\nFor more information about OData query options, see [Use query parameters to customize responses](query-parameters.md).\r\n\r\nAside from OData query options, some methods require parameter values specified as part of the query URL. For example, you can get a collection of events that occurred during a time period in a user's calendar, by querying the **calendarView** relationship of a **user**, and specifying the period `startDateTime` and `endDateTime` values as query parameters:\r\n\r\n<!-- {\r\n  \"blockType\": \"ignored\"\r\n}-->\r\n```http\r\nGET https://graph.microsoft.com/me/calendarView?startDateTime=2019-09-01T09:00:00.0000000&endDateTime=2019-09-01T17:00:00.0000000\r\n```\r\n\r\n## Headers\r\n\r\nMicrosoft Graph supports both HTTP standard headers and custom headers.\r\n\r\nSpecific APIs may require additional headers to be included in the request. On the other hand, Microsoft Graph will always return mandatory headers, such as the `request-id` header in the response, or some headers may be specific to some APIs or functionality, for example, the `Retry-After` header is included when your app hits throttling limits; or the `Location` header that's included for long-running operations.\r\n\r\nHeaders are case-insensitive as defined in [rfc 9110](https://www.rfc-editor.org/rfc/rfc9110.html) unless explicitly specified otherwise.\r\n\r\n## Tools for interacting with Microsoft Graph\r\n\r\n### Graph Explorer\r\n\r\nGraph Explorer is a web-based tool that you can use to build and test requests using Microsoft Graph APIs. You can access Graph Explorer at: [https://developer.microsoft.com/graph/graph-explorer](https://developer.microsoft.com/graph/graph-explorer).\r\n\r\nYou can either access demo data without signing in, or you can sign in to a tenant of your own. Use the following steps to build the request:\r\n\r\n1. Select the HTTP method.\r\n2. Select the version of API that you want to use.\r\n3. Type the query in the request text box.\r\n4. Select **Run Query**. \r\n\r\nThe following example shows a request that returns information about users in the demo tenant:\r\n\r\n![Screenshot of Graph Explorer with a GET user request highlighted](./images/graph-explorer.png)\r\n\r\nSample queries are provided in Graph Explorer to enable you to more quickly run common requests. To see the samples that are available, select **show more samples**. Select **On** for the set of samples that you want to see, and then after closing the selection window, you should see a list of predefined requests.\r\n\r\nA status code and message are displayed after a request is sent and the response is shown in the **Response Preview** tab.\r\n\r\n### Postman\r\n\r\nPostman is a tool that you can use to build and test requests using the Microsoft Graph APIs. You can download Postman at: [https://www.getpostman.com/](https://www.getpostman.com/). To interact with Microsoft Graph in Postman, you use the Microsoft Graph collection.\r\n\r\nFor more information, see [Use Postman with the Microsoft Graph API](./use-postman.md).\r\n\r\n## Next steps\r\n\r\nYou're ready to get up and running with Microsoft Graph. Try the [Quick Start](https://developer.microsoft.com/graph/quick-start), or get started using one of our [SDKs and code samples](https://developer.microsoft.com/graph/code-samples-and-sdks).\r\n"
  },
  {
    "id": "auth__auth-concepts",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Authentication and authorization basics\"\r\ndescription: \"To call Microsoft Graph, you must register your app with the Microsoft identity platform, request permissions, and acquire an access token.\"\r\nauthor: \"FaithOmbongi\"\r\nms.author: ombongifaith\r\nms.reviewer: jackson.woods\r\nms.localizationpriority: high\r\nms.prod: \"applications\"\r\nms.custom: graphiamtop20\r\nms.date: 05/25/2023\r\n---\r\n\r\n# Authentication and authorization basics\r\n\r\nMicrosoft Graph is a protected web API for accessing data in Microsoft cloud services like Azure Active Directory and Microsoft 365. It's protected by the Microsoft identity platform, which uses [OAuth access tokens](/azure/active-directory/develop/active-directory-v2-protocols) to verify that an app is authorized to call Microsoft Graph.\r\n\r\nThis article provides an overview of the Microsoft identity platform, access tokens, and how your app can get access tokens. For more information about the Microsoft identity platform, see [What is the Microsoft identity platform?](/azure/active-directory/develop/v2-overview). If you know how to integrate an app with the Microsoft identity platform to get tokens, see information and samples specific to Microsoft Graph in the [next steps](#see-also) section.\r\n\r\n## Register the application\r\n\r\nBefore your app can get an access token from the Microsoft identity platform, it must be registered in the [Microsoft Entra admin center](https://entra.microsoft.com/). Registration integrates your app with the Microsoft identity platform and establishes the information that it uses to get tokens, including:\r\n\r\n- **Application ID**: A unique identifier assigned by the Microsoft identity platform.\r\n- **Redirect URI/URL**: One or more endpoints at which your app receives responses from the Microsoft identity platform. (For native and mobile apps, the URI is assigned by the Microsoft identity platform.)\r\n- **Client secret**: A password that your app uses to authenticate with the Microsoft identity platform. You can optionally use a certificate or a federated identity credential. This property isn't required for public clients like native, mobile and single page applications.\r\n\r\nFor more information, see [Register an application with the Microsoft identity platform](../auth-register-app-v2.md).\r\n\r\n## Access scenarios\r\n\r\nThe method that an app uses to authenticate with the Microsoft identity platform depends on how you want the app to access the data. This access can be in one of two ways as illustrated in the following image.\r\n\r\n- **Delegated access**, an app acting on behalf of a signed-in user.\r\n- **App-only access**, an app acting with its own identity.\r\n\r\n:::image type=\"content\" source=\"../images/access-scenarios.png\" alt-text=\"Illustration of delegated and app-only access scenarios in the Microsoft identity platform.\":::\r\n\r\n### Delegated access (access on behalf of a user)\r\n\r\nIn this access scenario, a user has signed into a client application and the client application calls Microsoft Graph on behalf of the user. *Both the client and the user must be authorized to make the request*.\r\n\r\nDelegated access requires *delegated permissions*, also referred to as *scopes*. Scopes are permissions that are exposed by a given resource and they represent the operations that an app can perform on behalf of a user.\r\n\r\nBecause both the app and the user must be authorized to make the request, the resource grants the client app the delegated permissions, for the client app to access data on behalf of the specified user. For the user, the actions that they can perform on the resource rely on the permissions that they have to access the resource. For example, the user might be the owner of the resource, or they might be assigned a particular role through a role-based access control system (RBAC) such as [Azure AD RBAC](/azure/active-directory/roles/custom-overview).\r\n\r\n### App-only access (access without a user)\r\n\r\nIn this access scenario, the application can interact with data on its own, without a signed in user. *App-only* access is used in scenarios such as automation and backup, and is mostly used by apps that run as background services or daemons. It's suitable when it's undesirable to have a user signed in, or when the data required can't be scoped to a single user.\r\n\r\nApps get privileges to call Microsoft Graph with their own identity through one of the following ways:\r\n\r\n- When the app is assigned *application permissions*, also called *app roles*\r\n- When the app is assigned ownership of the resource that it intends to manage\r\n\r\n> [!NOTE]\r\n> An app can also get privileges through permissions granted by a role-based access control system such as [Azure AD RBAC](/azure/active-directory/roles/permissions-reference).\r\n\r\n## Microsoft Graph permissions\r\n\r\nMicrosoft Graph exposes granular permissions that control the access that apps have to Microsoft Graph resources, like users, groups, and mail. As a developer, you decide which Microsoft Graph permissions to request for your app based on the access scenario and the operations you want to perform.\r\n\r\nMicrosoft Graph exposes two types of permissions for the supported [access scenarios](#access-scenarios):\r\n\r\n- Delegated permissions: Also called *scopes*, allow the application to act on behalf of the signed-in user.\r\n- Application permissions: Also called *app roles*, allow the app to access data on its own, without a signed-in user.\r\n\r\nWhen a user signs in to an app, the app must specify the permissions it needs to be included in the access token. These permissions:\r\n\r\n- May be preauthorized for the application by an administrator.\r\n- May be consented by the user directly.\r\n- If not preauthorized, may require administrator privileges to grant consent. For example, for permissions with a greater potential security impact.\r\n\r\nFor more information about permissions and consent, see [Introduction to permissions and consent](/azure/active-directory/develop/permissions-consent-overview#consent).\r\n\r\n[!INCLUDE [auth-use-least-privileged](../../includes/auth-use-least-privileged.md)]\r\n\r\nFor more information about Microsoft Graph permissions and how to use them, see the [Overview of Microsoft Graph permissions](../permissions-overview.md).\r\n\r\n## Access tokens\r\n\r\nAn application makes an authentication request to the Microsoft identity platform to get access tokens that it uses to call an API, such as Microsoft Graph. Access tokens that the Microsoft identity platform issues contain *claims* which are details about the application and in delegated access scenarios, the user. Web APIs that are secured by the Microsoft identity platform, such as Microsoft Graph, use the claims to validate the caller and to ensure that the caller has the proper privileges to perform the operation they're requesting. The caller should treat access tokens as opaque strings because the contents of the token are intended for the API only. When calling Microsoft Graph, always protect access tokens by transmitting them over a secure channel that uses transport layer security (TLS).\r\n\r\nThe following example shows a Microsoft identity platform access token:\r\n\r\n```jwt\r\neyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Imk2bEdrM0ZaenhSY1ViMkMzbkVRN3N5SEpsWSJ9.eyJhdWQiOiI2ZTc0MTcyYi1iZTU2LTQ4NDMtOWZmNC1lNjZhMzliYjEyZTMiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3L3YyLjAiLCJpYXQiOjE1MzcyMzEwNDgsIm5iZiI6MTUzNzIzMTA0OCwiZXhwIjoxNTM3MjM0OTQ4LCJhaW8iOiJBWFFBaS84SUFBQUF0QWFaTG8zQ2hNaWY2S09udHRSQjdlQnE0L0RjY1F6amNKR3hQWXkvQzNqRGFOR3hYZDZ3TklJVkdSZ2hOUm53SjFsT2NBbk5aY2p2a295ckZ4Q3R0djMzMTQwUmlvT0ZKNGJDQ0dWdW9DYWcxdU9UVDIyMjIyZ0h3TFBZUS91Zjc5UVgrMEtJaWpkcm1wNjlSY3R6bVE9PSIsImF6cCI6IjZlNzQxNzJiLWJlNTYtNDg0My05ZmY0LWU2NmEzOWJiMTJlMyIsImF6cGFjciI6IjAiLCJuYW1lIjoiQWJlIExpbmNvbG4iLCJvaWQiOiI2OTAyMjJiZS1mZjFhLTRkNTYtYWJkMS03ZTRmN2QzOGU0NzQiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhYmVsaUBtaWNyb3NvZnQuY29tIiwicmgiOiJJIiwic2NwIjoiYWNjZXNzX2FzX3VzZXIiLCJzdWIiOiJIS1pwZmFIeVdhZGVPb3VZbGl0anJJLUtmZlRtMjIyWDVyclYzeERxZktRIiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidXRpIjoiZnFpQnFYTFBqMGVRYTgyUy1JWUZBQSIsInZlciI6IjIuMCJ9.pj4N-w_3Us9DrBLfpCt\r\n```\r\n\r\nAccess tokens are a kind of **security token** that the Microsoft identity platform provides. They're short-lived but with variable default lifetimes.\r\n\r\nTo call Microsoft Graph, the app makes an authorization request by attaching the access token as a **Bearer** token to the **Authorization** header in an HTTP request. For example, the following call that returns the profile information of the signed-in user (the access token has been shortened for readability):\r\n\r\n```http\r\nGET https://graph.microsoft.com/v1.0/me/ HTTP/1.1\r\nHost: graph.microsoft.com\r\nAuthorization: Bearer EwAoA8l6BAAU ... 7PqHGsykYj7A0XqHCjbKKgWSkcAg==\r\n```\r\n\r\n### Get an access token\r\n\r\nWe recommend that you use authentication libraries to manage your token interactions with the Microsoft identity platform. Authentication libraries abstract many protocol details like validation, cookie handling, token caching, and maintaining secure connections, that lets you focus your development on your app's functionality. Microsoft publishes open-source client libraries and server middleware.\r\n\r\nFor the Microsoft identity platform endpoint:\r\n\r\n- Microsoft Authentication Library (MSAL) client libraries are available for various frameworks including for .NET, JavaScript, Android, and iOS. All platforms are in production-supported preview, and, in the event breaking changes are introduced, Microsoft guarantees a path to upgrade.\r\n- Server middleware from Microsoft is available for .NET core and ASP.NET (OWIN OpenID Connect and OAuth) and for Node.js (Microsoft identity platform Passport.js).\r\n- The Microsoft identity platform is also compatible with many third-party authentication libraries.\r\n\r\nFor a complete list of Microsoft client libraries, Microsoft server middleware, and compatible third-party libraries, see [Microsoft identity platform documentation](/azure/active-directory/develop/).\r\n\r\nYou don't need to use an authentication library to get an access token. To learn about directly using the Microsoft identity platform endpoints without the help of an authentication library, see the following articles:\r\n\r\n- [Get access on behalf of a user](../auth-v2-user.md)\r\n- [Get access without a user](../auth-v2-service.md)\r\n\r\n## See also\r\n\r\n- [Microsoft identity platform documentation](/azure/active-directory/develop/).\r\n- [Choose a Microsoft Graph authentication provider based on scenario](../sdks/choose-authentication-providers.md).\r\n- [Overview of Microsoft Graph permissions](/graph/permissions-overview).\r\n- Use the [Get started](https://developer.microsoft.com/graph/get-started) page to find the libraries, samples, training content, and other resources for your favorite platform.\r\n- See our [Microsoft Graph samples](https://github.com/microsoftgraph?utf8=%E2%9C%93&q=sample&type=&language=) on GitHub.\r\n"
  },
  {
    "id": "sdks__batch-requests",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Use the Microsoft Graph SDKs to batch requests\"\r\ndescription: \"Provides instructions for creating a batch of API requests using the Microsoft Graph SDKs.\"\r\nms.localizationpriority: medium\r\nauthor: DarrelMiller\r\n---\r\n\r\n<!-- markdownlint-disable MD024 MD051 -->\r\n\r\n# Use the Microsoft Graph SDKs to batch requests\r\n\r\n[Batching](../json-batching.md) is a way of combining multiple requests into a single HTTP request. The requests are combined in a single JSON payload, which is sent via POST to the `\\$batch` endpoint. Microsoft Graph SDKs have a set of classes to simplify how you create batch payloads and parse batch response payloads.\r\n\r\n> [!IMPORTANT]\r\n> For current limitations with JSON batching in Microsoft Graph, see [Known Issues](https://developer.microsoft.com/en-us/graph/known-issues/?filterBy=JSON%20batching&search=).\r\n\r\n## Create a batch request\r\n\r\nThe Microsoft Graph SDKs provide three classes to work with batch requests and responses.\r\n\r\n- **BatchRequestStep** - Represents a single request (such as `GET /me`) within a batch. It enables assigning a unique identifier to the request and specifying dependencies between requests.\r\n- **BatchRequestContent** - Simplifies creating the batch request payload. It contains multiple **BatchRequestStep** objects.\r\n- **BatchResponseContent** - Simplifies parsing the response from a batch request. It provides the ability to get all responses, get a specific response by ID, and get the `@odata.nextLink` property if present.\r\n\r\n## Simple batching example\r\n\r\nThis example shows how to send multiple requests in a batch that are not dependent on each other. The requests can be run by the service in any order. This example gets the user and gets the user's calendar view for the current day.\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/BatchRequests.cs\" id=\"SimpleBatchSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/batch_requests.go\" id=\"SimpleBatchSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/BatchRequests.java\" id=\"SimpleBatchSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/batchRequests.ts\" id=\"SimpleBatchSnippet\":::\r\n\r\n---\r\n\r\n## Batches with dependent requests\r\n\r\nThis example shows how to send multiple requests in a batch that are dependent on each other. The requests will be run by the service in the order specified by the dependencies. This example adds an event with a start time during the current day to the user's calendar and gets the user's calendar view for the current day. To make sure that the calendar review returned includes the new event created, the request for the calendar view is configured as dependent on the request to add the new event. This ensures that the add event request will execute first.\r\n\r\n> [!NOTE]\r\n> If the add event request fails, the get calendar view request will fail with a `424 Failed Dependency` error.\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/BatchRequests.cs\" id=\"DependentBatchSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/batch_requests.go\" id=\"DependentBatchSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/BatchRequests.java\" id=\"DependentBatchSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/batchRequests.ts\" id=\"DependentBatchSnippet\":::\r\n\r\n---\r\n"
  },
  {
    "id": "sdks__choose-authentication-providers",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Choose a Microsoft Graph authentication provider\"\r\ndescription: \"Learn how to choose scenario-specific authentication providers for your application.\"\r\nms.localizationpriority: medium\r\nauthor: MichaelMainer\r\n---\r\n\r\n<!-- markdownlint-disable MD024 MD051 -->\r\n\r\n# Choose a Microsoft Graph authentication provider based on scenario\r\n\r\nAuthentication providers implement the code required to acquire a token using the Microsoft Authentication Library (MSAL); handle a number of potential errors for cases like incremental consent, expired passwords, and conditional access; and then set the HTTP request authorization header. The following table lists the set of providers that match the scenarios for different [application types](/azure/active-directory/develop/v2-app-types).\r\n\r\n| Scenario                                                                                               | Flow/Grant         | Audience               | Provider |\r\n|--------------------------------------------------------------------------------------------------------|--------------------|------------------------|-----|\r\n| [Single Page App](/azure/active-directory/develop/scenario-spa-acquire-token)                          | Authorization Code with PKCE | Delegated Consumer/Org | [Authorization code provider](#authorization-code-provider) |\r\n| [Web App that calls web APIs](/azure/active-directory/develop/scenario-web-app-call-api-acquire-token) |                    |                        |     |\r\n|                                                                                                        | Authorization Code | Delegated Consumer/Org | [Authorization code provider](#authorization-code-provider) |\r\n|                                                                                                        | Client Credentials | App Only               | [Client credentials provider](#client-credentials-provider) |\r\n| [Web API that calls web APIs](/azure/active-directory/develop/scenario-web-api-call-api-acquire-token) |                    |                        |     |\r\n|                                                                                                        | On Behalf Of       | Delegated Consumer/Org | [On-behalf-of provider](#on-behalf-of-provider) |\r\n|                                                                                                        | Client Credentials | App Only               | [Client credentials provider](#client-credentials-provider) |\r\n| [Desktop app that calls web APIs](/azure/active-directory/develop/scenario-desktop-acquire-token)      |                    |                        |     |\r\n|                                                                                                        | Interactive        | Delegated Consumer/Org | [Interactive provider](#interactive-provider) |\r\n|                                                                                                        | Integrated Windows | Delegated Org          | [Integrated Windows provider](#integrated-windows-provider) |\r\n|                                                                                                        | Resource Owner     | Delegated Org          | [Username/password provider](#usernamepassword-provider) |\r\n|                                                                                                        | Device Code        | Delegated Org          | [Device code provider](#device-code-provider) |\r\n| [Daemon app](/azure/active-directory/develop/scenario-daemon-acquire-token)                            |                    |                        |     |\r\n|                                                                                                        | Client Credentials | App Only               | [Client credentials provider](#client-credentials-provider) |\r\n| [Mobile app that calls web APIs](/azure/active-directory/develop/scenario-mobile-acquire-token)        |                    |                        |     |\r\n|                                                                                                        | Interactive        | Delegated Consumer/Org | [Interactive provider](#interactive-provider) |\r\n\r\n> [!NOTE]\r\n> The following code snippets were written with the latest versions of their respective SDKs. If you encounter compiler errors with these snippets, make sure you have the latest versions. The authentication providers used are provided by the following Azure Identity libraries:\r\n>\r\n> - .NET developers need to add the [Azure.Identity](/dotnet/api/azure.identity) package.\r\n> - TypeScript and JavaScript developers need to add the [@azure/identity](/javascript/api/@azure/identity) library.\r\n> - Java and Android developers need to add the [azure-identity](/java/api/overview/azure/identity-readme) library.\r\n\r\n## Authorization code provider\r\n\r\nThe authorization code flow enables native and web apps to securely obtain tokens in the name of the user. To learn more, see [Microsoft identity platform and OAuth 2.0 authorization code flow](/azure/active-directory/develop/v2-oauth2-auth-code-flow).\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"AuthorizationCodeSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\nThe [Azure Identity Client Module for Go](https://pkg.go.dev/github.com/Azure/azure-sdk-for-go/sdk/azidentity) does not support the authorization code flow.\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"AuthorizationCodeSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\nIn the following example we are using the asynchronous [AuthorizationCodeCredential](/python/api/azure-identity/azure.identity.aio.authorizationcodecredential?view=azure-python&preserve-view=true). You can alternatively use the [synchronous version](/python/api/azure-identity/azure.identity.authorizationcodecredential?view=azure-python&preserve-view-true) of this credential.\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"AuthorizationCodeSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n### Using @azure/msal-browser for browser applications\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"BrowserSnippet\":::\r\n\r\n### Using @azure/identity for server-side applications\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"AuthorizationCodeSnippet\":::\r\n\r\n---\r\n\r\n## Client credentials provider\r\n\r\nThe client credential flow enables service applications to run without user interaction. Access is based on the identity of the application. For more information, see [Microsoft identity platform and the OAuth 2.0 client credentials flow](/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow).\r\n\r\n### [C#](#tab/csharp)\r\n\r\n### Using a client certificate\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"ClientCertificateSnippet\":::\r\n\r\n### Using a client secret\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"ClientSecretSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n### Using a client certificate\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"ClientCertificateSnippet\":::\r\n\r\n### Using a client secret\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"ClientSecretSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n### Using a client certificate\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"ClientCertificateSnippet\":::\r\n\r\n### Using a client secret\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"ClientSecretSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n### Using a client certificate\r\n\r\nIn the following example we are using the asynchronous [CertificateCredential](/python/api/azure-identity/azure.identity.aio.certificatecredential?view=azure-python&preserve-view=true). You can alternatively use the [synchronous version](/python/api/azure-identity/azure.identity.certificatecredential?view=azure-python&preserve-view-true) of this credential.\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"ClientCertificateSnippet\":::\r\n\r\n### Using a client secret\r\n\r\nIn the following example we are using the asynchronous [ClientSecretCredential](/python/api/azure-identity/azure.identity.aio.clientsecretcredential?view=azure-python&preserve-view=true). You can alternatively use the [synchronous version](/python/api/azure-identity/azure.identity.clientsecretcredential?view=azure-python&preserve-view-true) of this credential.\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"ClientSecretSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n### Using a client certificate\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"ClientCertificateSnippet\":::\r\n\r\n### Using a client secret\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"ClientSecretSnippet\":::\r\n\r\n---\r\n\r\n## On-behalf-of provider\r\n\r\nThe on-behalf-of flow is applicable when your application calls a service/web API which in turns calls the Microsoft Graph API. Learn more by reading [Microsoft identity platform and OAuth 2.0 On-Behalf-Of flow](/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow)\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"OnBehalfOfSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"OnBehalfOfSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"OnBehalfOfSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\nIn the following example we are using the asynchronous [OnBehalfOfCredential](/python/api/azure-identity/azure.identity.aio.onbehalfofcredential?view=azure-python&preserve-view=true). You can alternatively use the [synchronous version](/python/api/azure-identity/azure.identity.onbehalfofcredential?view=azure-python&preserve-view-true) of this credential.\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"OnBehalfOfSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"OnBehalfOfSnippet\":::\r\n\r\n---\r\n\r\n## Implicit provider\r\n\r\nImplicit Authentication flow is not recommended due to its [disadvantages](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-browser-based-apps-04#section-9.8.6). Public clients such as native apps and single-page apps should now use the authorization code flow with the PKCE extension instead. [Reference](https://oauth.net/2/grant-types/implicit/).\r\n\r\n## Device code provider\r\n\r\nThe device code flow enables sign in to devices by way of another device. For details, see [Microsoft identity platform and the OAuth 2.0 device code flow](/azure/active-directory/develop/v2-oauth2-device-code).\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"DeviceCodeSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"DeviceCodeSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"DeviceCodeSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"DeviceCodeSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"DeviceCodeSnippet\":::\r\n\r\n---\r\n\r\n## Integrated Windows provider\r\n\r\nThe integrated Windows flow provides a way for Windows computers to silently acquire an access token when they are domain joined. For details, see [Integrated Windows authentication](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/Integrated-Windows-Authentication).\r\n\r\n### [C#](#tab/csharp)\r\n\r\nThe `Azure.Identity` package does not currently support Windows integrated authentication. Instead create a custom access token provider using MSAL.\r\n\r\n### Access token provider\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/IntegratedWindowsTokenProvider.cs\" id=\"IntegratedWindowsTokenProviderSnippet\":::\r\n\r\n### Create the client\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"IntegratedWindowsSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\nNot applicable.\r\n\r\n### [Java](#tab/java)\r\n\r\nNot applicable.\r\n\r\n### [Python](#tab/python)\r\n\r\nNot applicable.\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\nNot applicable.\r\n\r\n---\r\n\r\n## Interactive provider\r\n\r\nThe interactive flow is used by mobile applications (Xamarin and UWP) and desktops applications to call Microsoft Graph in the name of a user. For details, see [Acquiring tokens interactively](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/Acquiring-tokens-interactively).\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"InteractiveSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"InteractiveSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"InteractiveSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"InteractiveSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"InteractiveSnippet\":::\r\n\r\n---\r\n\r\n## Username/password provider\r\n\r\nThe username/password provider allows an application to sign in a user by using their username and password. Use this flow only when you cannot use any of the other OAuth flows. For more information, see [Microsoft identity platform and the OAuth 2.0 resource owner password credential](/azure/active-directory/develop/v2-oauth-ropc)\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"UserNamePasswordSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"UserNamePasswordSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"UserNamePasswordSnippet\":::\r\n\r\n### [Python](#tab/python)\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"UserNamePasswordSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"UserNamePasswordSnippet\":::\r\n\r\n---\r\n\r\n## Next steps\r\n\r\n- For code samples that show you how to use the Microsoft identity platform to secure different application types, see [Microsoft identity platform code samples (v2.0 endpoint)](/azure/active-directory/develop/sample-v2-code).\r\n- Authentication providers require an client ID. You'll want to [register your application](https://entra.microsoft.com/) after you set up your authentication provider.\r\n- Let us know if a required OAuth flow isn't currently supported by voting for or opening a [Microsoft Graph feature request](https://aka.ms/graphrequests).\r\n"
  },
  {
    "id": "sdks__create-client",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Create a Microsoft Graph client\"\r\ndescription: \"Describes how to create a client to use to make calls to Microsoft Graph. Includes how to set up authentication and select a sovereign cloud.\"\r\nms.localizationpriority: medium\r\nauthor: MichaelMainer\r\n---\r\n\r\n# Create a Microsoft Graph client\r\n\r\nThe Microsoft Graph client is designed to make it simple to make calls to Microsoft Graph. You can use a single client instance for the lifetime of the application. For information about how to add and install the Microsoft Graph client package into your project, see  [Install the SDK](sdk-installation.md).\r\n\r\nThe following code examples show how to create an instance of a Microsoft Graph client with an authentication provider in the supported languages. The authentication provider will handle acquiring access tokens for the application. Many different authentication providers are available for each language and platform. The different authentication providers support different client scenarios. For details about which provider and options are appropriate for your scenario, see [Choose an Authentication Provider](choose-authentication-providers.md).\r\n\r\n<!-- markdownlint-disable MD025 MD051 -->\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateClients.cs\" id=\"DeviceCodeSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_clients.go\" id=\"DeviceCodeSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateClients.java\" id=\"DeviceCodeSnippet\":::\r\n\r\n# [PHP](#tab/php)\r\n\r\n```php\r\n// PHP client currently doesn't have an authentication provider. You will need to handle\r\n// getting an access token. The following example demonstrates the client credential\r\n// OAuth flow and assumes that an administrator has consented to the application.\r\n$guzzle = new \\GuzzleHttp\\Client();\r\n$url = 'https://login.microsoftonline.com/' . $tenantId . '/oauth2/token?api-version=1.0';\r\n$token = json_decode($guzzle->post($url, [\r\n    'form_params' => [\r\n        'client_id' => $clientId,\r\n        'client_secret' => $clientSecret,\r\n        'resource' => 'https://graph.microsoft.com/',\r\n        'grant_type' => 'client_credentials',\r\n    ],\r\n])->getBody()->getContents());\r\n$accessToken = $token->access_token;\r\n\r\n// Create a new Graph client.\r\n$graph = new Graph();\r\n$graph->setAccessToken($accessToken);\r\n\r\n// Make a call to /me Graph resource.\r\n$user = $graph->createRequest(\"GET\", \"/me\")\r\n              ->setReturnType(Model\\User::class)\r\n              ->execute();\r\n```\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_clients.py\" id=\"DeviceCodeSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createClients.ts\" id=\"DeviceCodeSnippet\":::\r\n\r\n---\r\n"
  },
  {
    "id": "sdks__create-requests",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Make API calls using the Microsoft Graph SDKs\"\r\ndescription: \"Provides instructions for creating Microsoft Graph HTTP requests using the SDKs.\"\r\nms.localizationpriority: medium\r\nauthor: DarrelMiller\r\n---\r\n\r\n<!-- markdownlint-disable MD025 MD051 -->\r\n\r\n# Make API calls using the Microsoft Graph SDKs\r\n\r\nThe Microsoft Graph SDK service libraries provide a client class that you can use as the starting point for creating all API requests. There are two styles of client class: one uses a fluent interface to create the request (for example, `client.Users[\"user-id\"].Manager`) and the other accepts a path string (for example, `api(\"/users/user-id/manager\")`). When you have a request object, you can specify a variety of options such as filtering and sorting, and finally, you select the type of operation you want to perform.\r\n\r\nThere is also the [Microsoft Graph PowerShell SDK](/powershell/microsoftgraph/get-started), which has no client class at all. Instead, all requests are represented as PowerShell commands. For example, to get a user's manager, the command is `Get-MgUserManager`. For more information on finding commands for API calls, see [Navigating the Microsoft Graph PowerShell SDK](/powershell/microsoftgraph/navigating).\r\n\r\n## Read information from Microsoft Graph\r\n\r\nTo read information from Microsoft Graph, you first need to create a request object and then run the `GET` method on the request.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"ReadRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"ReadRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"ReadRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-read.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"ReadRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"ReadRequestSnippet\":::\r\n\r\n---\r\n\r\n## Use $select to control the properties returned\r\n\r\nWhen retrieving an entity, not all properties are automatically retrieved; sometimes they need to be explicitly selected. Also, in some scenarios it isn't necessary to return the default set of properties. Selecting just the required properties can improve the performance of the request. You can customize the request to include the `$select` query parameter with a list of properties.\r\n\r\n<!-- markdownlint-disable MD024 -->\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"SelectRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"SelectRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"SelectRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-select.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"SelectRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"SelectRequestSnippet\":::\r\n\r\n---\r\n\r\n## Retrieve a list of entities\r\n\r\nRetrieving a list of entities is similar to retrieving a single entity except there a number of other options for configuring the request. The `$filter` query parameter can be used to reduce the result set to only those rows that match the provided condition.  The `$orderby` query parameter will request that the server provide the list of entities sorted by the specified properties.\r\n\r\n[!INCLUDE [aad-advanced-queries-note](../../includes/aad-advanced-queries-note.md)]\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"ListRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"ListRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"ListRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-list.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"ListRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"ListRequestSnippet\":::\r\n\r\n---\r\n\r\nThe object returned when retrieving a list of entities is likely to be a paged collection. For details about how to get the complete list of entities, see [paging through a collection](../paging.md).\r\n\r\n## Access an item of a collection\r\n\r\nFor SDKs that support a fluent style, collections of entities can be accessed using an array index. For template-based SDKs, it is sufficient to embed the item identifier in the path segment following the collection. For PowerShell, identifiers are passed as parameters.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"ItemByIdRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"ItemByIdRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"ItemByIdRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-index.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"ItemByIdRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"ItemByIdRequestSnippet\":::\r\n\r\n---\r\n\r\n## Use $expand to access related entities\r\n\r\nYou can use the `$expand` filter to request a related entity, or collection of entities, at the same time that you request the main entity.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"ExpandRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"ExpandRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"ExpandRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-expand.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"ExpandRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"ExpandRequestSnippet\":::\r\n\r\n---\r\n\r\n## Delete an entity\r\n\r\nDelete requests are constructed in the same way as requests to retrieve an entity, but use a `DELETE` request instead of a `GET`.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"DeleteRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"DeleteRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"DeleteRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-delete.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"DeleteRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"DeleteRequestSnippet\":::\r\n\r\n---\r\n\r\n## Make a POST request to create a new entity\r\n\r\nFor SDKs that support a fluent style, new items can be added to collections with an `Add` method. For template-based SDKs, the request object exposes a `post` method. For PowerShell, a `New-*` command is available that accepts parameters that map to the entity to add. The created entity is usually returned from the call.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"CreateRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"CreateRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"CreateRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-create.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"CreateRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"CreateRequestSnippet\":::\r\n\r\n---\r\n\r\n## Updating an existing entity with PATCH\r\n\r\nMost updates in Microsoft Graph are performed using a `PATCH` method and therefore it is only necessary to include the properties that you want to change in the object you pass.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"UpdateRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"UpdateRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"UpdateRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-update.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"UpdateRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"UpdateRequestSnippet\":::\r\n\r\n---\r\n\r\n## Use HTTP headers to control request behavior\r\n\r\nYou can use a `Header()` function to attach custom headers to a request. For PowerShell, adding headers is only possible with the `Invoke-GraphRequest` method. A number of Microsoft Graph scenarios use custom headers to adjust the behavior of the request.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"HeadersRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"HeadersRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"HeadersRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-headers.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"HeadersRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"HeadersRequestSnippet\":::\r\n\r\n---\r\n\r\n## Provide custom query parameters\r\n\r\nFor SDKs that support a fluent style, you can provide custom query parameter values by using a list of `QueryOptions` objects. For template-based SDKs, the parameters are URL-encoded and added to the request URI. For PowerShell and Go, defined query parameters for a given API are exposed as parameters to the corresponding command.\r\n\r\n# [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CreateRequests.cs\" id=\"QueryParametersRequestSnippet\":::\r\n\r\n# [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/create_requests.go\" id=\"QueryParametersRequestSnippet\":::\r\n\r\n# [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CreateRequests.java\" id=\"QueryParametersRequestSnippet\":::\r\n\r\n# [PowerShell](#tab/powershell)\r\n\r\n[!INCLUDE [sample-code](includes/snippets/powershell/create-requests-queryparams.md)]\r\n\r\n# [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/create_requests.py\" id=\"QueryParametersRequestSnippet\":::\r\n\r\n# [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/createRequests.ts\" id=\"QueryParametersRequestSnippet\":::\r\n\r\n---\r\n"
  },
  {
    "id": "sdks__customize-client",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Customize the Microsoft Graph SDK service client\"\r\ndescription: \"Provides instructions on how to change the default behavior of the Microsoft Graph SDK service client.\"\r\nms.localizationpriority: medium\r\nauthor: DarrelMiller\r\n---\r\n\r\n# Customize the Microsoft Graph SDK service client\r\n\r\nThe Microsoft Graph SDK client configures a default set of middleware that allows the SDK to communicate with the Microsoft Graph endpoints. This default set is customizable, allowing you to change the behavior of the client. For example, you can insert customized logging, or add a test handler to simulate specific scenarios. You can add and remove middleware components. It is important to note that the order in which middleware components run is significant.\r\n\r\n<!-- markdownlint-disable MD051 -->\r\n## [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CustomClients.cs\" id=\"ChaosHandlerSnippet\":::\r\n\r\n## [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/custom_clients.go\" id=\"ImportSnippet\":::\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/custom_clients.go\" id=\"ChaosHandlerSnippet\":::\r\n\r\n## [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CustomClients.java\" id=\"ChaosHandlerSnippet\":::\r\n\r\n## [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/custom_clients.py\" id=\"CustomMiddlewareSnippet\":::\r\n\r\n## Custom middleware\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/middleware/custom_middleware.py\" id=\"CustomMiddlewareSnippet\":::\r\n\r\n## [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/customClients.ts\" id=\"ChaosHandlerSnippet\":::\r\n\r\n---\r\n\r\n## Configuring the HTTP proxy for the client\r\n\r\nSome environments require client applications to use a HTTP proxy before they can access the public internet. This section shows how to configure the proxy for the Microsoft Graph SDKs.\r\n\r\n<!-- markdownlint-disable MD024 -->\r\n## [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/CustomClients.cs\" id=\"ProxySnippet\":::\r\n\r\n## [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/custom_clients.go\" id=\"ImportSnippet\":::\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/custom_clients.go\" id=\"ProxySnippet\":::\r\n\r\n## [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/CustomClients.java\" id=\"ProxySnippet\":::\r\n\r\n## [Python](#tab/python)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/custom_clients.py\" id=\"ProxySnippet\":::\r\n\r\n## [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/customClients.ts\" id=\"ProxySnippet\":::\r\n\r\n---\r\n"
  },
  {
    "id": "sdks__large-file-upload",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Upload large files using the Microsoft Graph SDKs\"\r\ndescription: \"Provides guidance for uploading large files using the Microsoft Graph SDKs.\"\r\nms.localizationpriority: medium\r\nauthor: DarrelMiller\r\n---\r\n\r\n<!-- markdownlint-disable MD024 MD051 -->\r\n\r\n# Upload large files using the Microsoft Graph SDKs\r\n\r\nA number of entities in Microsoft Graph support [resumable file uploads](/graph/api/driveitem-createuploadsession?view=graph-rest-1.0&preserve-view=true) to make it easier to upload large files. Instead of trying to upload the entire file in a single request, the file is sliced into smaller pieces and a request is used to upload a single slice. In order to simplify this process, the Microsoft Graph SDKs implement a large file upload task that manages the uploading of the slices.\r\n\r\n## Upload large file to OneDrive\r\n\r\n## [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/LargeFileUpload.cs\" id=\"LargeFileUploadSnippet\":::\r\n\r\n## [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/LargeFileUpload.java\" id=\"LargeFileUploadSnippet\":::\r\n\r\n## [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/largeFileUpload.ts\" id=\"LargeFileUploadSnippet\":::\r\n\r\n---\r\n\r\n## Resuming a file upload\r\n\r\nThe Microsoft Graph SDKs support [resuming in-progress uploads](/graph/api/driveitem-createuploadsession?view=graph-rest-1.0&preserve-view=true#resuming-an-in-progress-upload). If your application encounters a connection interruption or a 5.x.x HTTP status during upload, you can resume the upload.\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/LargeFileUpload.cs\" id=\"ResumeSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n> [!NOTE]\r\n> The Java SDK does not currently support resuming in-progress downloads.\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/largeFileUpload.ts\" id=\"ResumeSnippet\":::\r\n\r\n---\r\n\r\n## Upload large attachment to Outlook message\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/LargeFileUpload.cs\" id=\"UploadAttachmentSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/LargeFileUpload.java\" id=\"UploadAttachmentSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/largeFileUpload.ts\" id=\"UploadAttachmentSnippet\":::\r\n\r\n---\r\n\r\n<!-- markdownlint-enable MD024 -->\r\n"
  },
  {
    "id": "sdks__national-clouds",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Access national cloud deployments with the Microsoft Graph SDKs\"\r\ndescription: \"Provides instructions for accessing national cloud deployments using the Microsoft Graph SDKs.\"\r\nms.localizationpriority: medium\r\nauthor: jasonjoh\r\n---\r\n\r\n<!-- markdownlint-disable MD051 -->\r\n\r\n# Access national cloud deployments with the Microsoft Graph SDKs\r\n\r\nBy default, the Microsoft Graph SDKs are configured to access data in the Microsoft Graph global service, using the `https://graph.microsoft.com` root URL to access the Microsoft Graph REST API. Developers can override this configuration to connect to [Microsoft Graph national cloud deployments](../deployments.md).\r\n\r\n## Prerequisites\r\n\r\nYou will need the following information to configure a Microsoft Graph SDK to connect to a national cloud deployment.\r\n\r\n- Application registration details, such as client ID, tenant ID, and client secret or certificate. The application registration MUST be created in the Microsoft Entra admin center that corresponds to the national cloud deployment. See [App registration and token service root endpoints](../deployments.md#app-registration-and-token-service-root-endpoints) for details.\r\n- The token endpoint for the national cloud deployment.\r\n- The Microsoft Graph service root endpoint for the national cloud deployment. See [Microsoft Graph and Graph Explorer service root endpoints](../deployments.md#microsoft-graph-and-graph-explorer-service-root-endpoints) for a list of endpoints.\r\n\r\n## Configure the SDK\r\n\r\nIn order to connect to a national cloud deployment, you must configure your [authentication provider](choose-authentication-providers.md) to connect to the correct token service endpoint. Then you must configure the SDK client to connect to the correct Microsoft Graph service root endpoint.\r\n\r\n### Permission scopes\r\n\r\nAny permission scope value (including the `.default` scope) that contains the Microsoft Graph domain MUST use the domain of the Microsoft Graph service root endpoint for the national cloud deployment. The shortened permission scope names, such as `User.Read` or `Mail.Send`, are also valid.\r\n\r\n- For [incremental or dynamic consent](/azure/active-directory/develop/consent-types-developer#incremental-and-dynamic-user-consent), `User.Read` and `https://graph.microsoft.us/User.Read` are equivalent for the US Government L4 national cloud.\r\n- For [statically defined permissions](/azure/active-directory/develop/consent-types-developer#request-the-permissions-in-the-app-registration-portal), or if you are using [client credentials flow](/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow) for app-only permissions, `https://graph.microsoft.us/.default` is the correct `.default` scope value.\r\n\r\n## Examples\r\n\r\nThe following example configures an [Interactive authentication provider](choose-authentication-providers.md#interactive-provider) with the Microsoft Graph SDK to connect to the Microsoft Graph for US Government L4 national cloud.\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/NationalClouds.cs\" id=\"NationalCloudSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/national_clouds.go\" id=\"ImportSnippet\":::\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/national_clouds.go\" id=\"NationalCloudSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/NationalClouds.java\" id=\"NationalCloudSnippet\":::\r\n\r\n### [PowerShell](#tab/powershell)\r\n\r\n```powershell\r\nConnect-MgGraph -Environment USGov -ClientId 'YOUR_CLIENT_ID' `\r\n  -TenantId 'YOUR_TENANT_ID' -Scopes 'https://graph.microsoft.us/.default'\r\n```\r\n\r\n### [Python](#tab/python)\r\n\r\n:::code language=\"python\" source=\"./snippets/python/src/snippets/national_clouds.py\" id=\"NationalCloudSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/typescript/src/snippets/nationalClouds.ts\" id=\"NationalCloudSnippet\":::\r\n\r\n---\r\n"
  },
  {
    "id": "sdks__paging",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Page through a collection using the Microsoft Graph SDKs\"\r\ndescription: \"Provides instructions for creating Microsoft Graph API requests using the Microsoft Graph SDKs.\"\r\nms.localizationpriority: medium\r\nauthor: DarrelMiller\r\n---\r\n\r\n<!-- markdownlint-disable MD051 -->\r\n\r\n# Page through a collection using the Microsoft Graph SDKs\r\n\r\nFor performance reasons, collections of entities are often split into pages and each page is returned with a URL to the next page. The **PageIterator** class simplifies consuming of paged collections. **PageIterator** handles enumerating the current page and requesting subsequent pages automatically.\r\n\r\n## Request headers\r\n\r\nIf you send any additional request headers in your initial request, those headers are not included by default in subsequent page requests. If those headers need to be sent on subsequent requests, you must set them explicitly.\r\n\r\n## Iterate over all the messages\r\n\r\nThe following example shows iterating over all the messages in a user's mailbox.\r\n\r\n> [!TIP]\r\n> This example sets a small page size using the `top` parameter for demonstration purposes. You can set the page size up to 999 to minimize the number of requests that are necessary.\r\n\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/Paging.cs\" id=\"PagingSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/paging.go\" id=\"ImportSnippet\":::\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/paging.go\" id=\"PagingSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n> [!NOTE]\r\n> The Microsoft Graph Java SDK does not currently have a **PageIterator** class. Instead, you need to request each page as shown in the following code.\r\n\r\n:::code language=\"java\" source=\"./snippets/java/app/src/main/java/snippets/Paging.java\" id=\"PagingSnippet\":::\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/paging.ts\" id=\"PagingSnippet\":::\r\n\r\n---\r\n\r\n## Stopping and resuming the iteration\r\n\r\nSome scenarios require stopping the iteration process in order to perform other actions. It is possible to pause the iteration by returning `false` from the iteration callback. Iteration can be resumed by calling the `resume` method on the **PageIterator**.\r\n\r\n<!-- markdownlint-disable MD024 -->\r\n### [C#](#tab/csharp)\r\n\r\n:::code language=\"csharp\" source=\"./snippets/dotnet/src/SdkSnippets/Snippets/Paging.cs\" id=\"ResumePagingSnippet\":::\r\n\r\n### [Go](#tab/go)\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/paging.go\" id=\"ImportSnippet\":::\r\n\r\n:::code language=\"go\" source=\"./snippets/go/src/snippets/paging.go\" id=\"ResumePagingSnippet\":::\r\n\r\n### [Java](#tab/java)\r\n\r\n```java\r\n// not supported in java SDK\r\n```\r\n\r\n### [TypeScript](#tab/typescript)\r\n\r\n:::code language=\"typescript\" source=\"./snippets/typescript/src/snippets/paging.ts\" id=\"ResumePagingSnippet\":::\r\n\r\n---\r\n<!-- markdownlint-enable MD024 -->\r\n"
  },
  {
    "id": "sdks__sdk-installation",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Install a Microsoft Graph SDK\"\r\ndescription: \"Find instructions for installing the Microsoft Graph SDKs for .NET, Go, Java, JavaScript, PHP, PowerShell, and Python.\"\r\nms.localizationpriority: medium\r\nauthor: MichaelMainer\r\n---\r\n\r\n# Install a Microsoft Graph SDK\r\n\r\nMicrosoft Graph SDKs are available to be included in your projects via GitHub and popular platform package managers. This article describes how you can install a Microsoft Graph SDK into your project.\r\n\r\nSDKs are available in the following languages:\r\n\r\n- [.NET](#install-the-microsoft-graph-net-sdk)\r\n- [Go](#install-the-microsoft-graph-go-sdk)\r\n- [Java](#install-the-microsoft-graph-java-sdk)\r\n- [JavaScript](#install-the-microsoft-graph-javascript-sdk)\r\n- [PHP](#install-the-microsoft-graph-php-sdk)\r\n- [PowerShell](#install-the-microsoft-graph-powershell-sdk)\r\n- [Python (preview)](#install-the-microsoft-graph-python-sdk-preview)\r\n\r\n## Install the Microsoft Graph .NET SDK\r\n\r\nThe Microsoft Graph .NET SDK is included in the following NuGet packages:\r\n\r\n- [Microsoft.Graph](https://github.com/microsoftgraph/msgraph-sdk-dotnet): Contains the models and request builders for accessing the `v1.0` endpoint with the fluent API. Microsoft.Graph has a dependency on Microsoft.Graph.Core.\r\n- [Microsoft.Graph.Beta](https://github.com/microsoftgraph/msgraph-beta-sdk-dotnet): Contains the models and request builders for accessing the `beta` endpoint with the fluent API. Microsoft.Graph.Beta has a dependency on Microsoft.Graph.Core.\r\n- [Microsoft.Graph.Core](https://github.com/microsoftgraph/msgraph-sdk-dotnet): The core library for making calls to Microsoft Graph.\r\n\r\nTo install the Microsoft.Graph packages into your project, you can use the [dotnet CLI](/nuget/quickstart/install-and-use-a-package-using-the-dotnet-cli), the [Package Manager UI in Visual Studio](/nuget/quickstart/install-and-use-a-package-in-visual-studio#nuget-package-manager) or the [Package Manager Console in Visual Studio](/nuget/quickstart/install-and-use-a-package-in-visual-studio#package-manager-console). The following commands install the Microsoft.Graph and Microsoft.Graph.Core libraries. Microsoft.Graph.Core is installed as a dependency of Microsoft.Graph.\r\n\r\n### dotnet CLI\r\n\r\n```dotnetcli\r\ndotnet add package Microsoft.Graph\r\n```\r\n\r\n### Package Manager Console\r\n\r\n```powershell\r\nInstall-Package Microsoft.Graph\r\n```\r\n\r\n## Install the Microsoft Graph Go SDK\r\n\r\nThe Microsoft Graph Go SDK is included in the following packages:\r\n\r\n- [Microsoft Graph SDK for Go](https://github.com/microsoftgraph/msgraph-sdk-go): Contains the models and request builders for accessing the `v1.0` endpoint with the fluent API.\r\n- [Microsoft Graph Beta SDK for Go](https://github.com/microsoftgraph/msgraph-beta-sdk-go): Contains the models and request builders for accessing the `beta` endpoint with the fluent API.\r\n- [Microsoft Graph Core SDK for Go](https://github.com/microsoftgraph/msgraph-sdk-go-core): The core library for making calls to Microsoft Graph.\r\n\r\n```Shell\r\ngo get github.com/microsoftgraph/msgraph-sdk-go\r\ngo get github.com/Azure/azure-sdk-for-go/sdk/azidentity\r\n```\r\n\r\n## Install the Microsoft Graph Java SDK\r\n\r\nThe Microsoft Graph Java SDK is included in the following packages:\r\n\r\n- [microsoft-graph](https://github.com/microsoftgraph/msgraph-sdk-java): Contains the models and request builders for accessing the `v1.0` endpoint with the fluent API.\r\n- [microsoft-graph-beta](https://github.com/microsoftgraph/msgraph-beta-sdk-java): Contains the models and request builders for accessing the `beta` endpoint with the fluent API.\r\n- [microsoft-graph-core](https://github.com/microsoftgraph/msgraph-sdk-java-core): The core library for making calls to Microsoft Graph.\r\n- [microsoft-graph-auth](https://github.com/microsoftgraph/msgraph-sdk-java-auth): Provides an authentication scenario-based wrapper of Microsoft Authentication Library (MSAL) for use with the Microsoft Graph SDK.\r\n\r\nTo install the Microsoft Graph Java SDK, do one of the following:\r\n\r\n- Use Gradle to install the Microsoft Graph Java SDK. Add the repository and a compile dependency for microsoft-graph to your project's build.gradle:\r\n\r\n  ```gradle\r\n    repository {\r\n        mavenCentral()\r\n    }\r\n\r\n    dependency {\r\n        // Include the sdk as a dependency\r\n        implementation 'com.microsoft.graph:microsoft-graph:5.+'\r\n        // Include Azure identity for authentication\r\n        implementation 'com.azure:azure-identity:1.+'\r\n    }\r\n  ```\r\n\r\n- Use Maven to install the Microsoft Graph Java SDK. Add the dependency in the `dependencies` element in pom.xml:\r\n\r\n  ```xml\r\n    <dependency>\r\n        <groupId>com.microsoft.graph</groupId>\r\n        <artifactId>microsoft-graph</artifactId>\r\n        <version>[5.0,)</version>\r\n    </dependency>\r\n    <dependency>\r\n        <groupId>com.azure</groupId>\r\n        <artifactId>azure-identity</artifactId>\r\n        <version>[1.3,)</version>\r\n    </dependency>\r\n  ```\r\n\r\n## Install the Microsoft Graph JavaScript SDK\r\n\r\nThe Microsoft Graph JavaScript SDK is included in the following packages:\r\n\r\n- @microsoft/microsoft-graph-client ([npm](https://www.npmjs.com/package/@microsoft/microsoft-graph-client)): The core library for making calls to Microsoft Graph.\r\n- @microsoft/microsoft-graph-types ([npm](https://www.npmjs.com/package/@microsoft/microsoft-graph-types)): The TypeScript types for the Microsoft Graph entities.\r\n\r\nUse [npm](https://www.npmjs.com) to install the Microsoft Graph JavaScript SDK:\r\n\r\n```Shell\r\nnpm install @microsoft/microsoft-graph-client --save\r\nnpm install @microsoft/microsoft-graph-types --save-dev\r\n```\r\n\r\n## Install the Microsoft Graph PHP SDK\r\n\r\nThe [Microsoft Graph PHP SDK](https://github.com/microsoftgraph/msgraph-sdk-php) is available from [packagist.org](https://packagist.org/packages/microsoft/microsoft-graph) and can be installed in the following ways:\r\n\r\n- Use composer to install the Microsoft Graph PHP SDK manually:\r\n\r\n    ```Shell\r\n    composer require microsoft/microsoft-graph\r\n    ```\r\n\r\n- Use composer.json to install the Microsoft Graph PHP SDK:\r\n\r\n    ```json\r\n    {\r\n        \"require\": {\r\n            \"microsoft/microsoft-graph\": \"^1.8\"\r\n        }\r\n    }\r\n    ```\r\n\r\n## Install the Microsoft Graph PowerShell SDK\r\n\r\nAll the modules are published on [PowerShell Gallery](https://www.powershellgallery.com/packages/Microsoft.Graph). To install:\r\n\r\n``` powershell\r\nInstall-Module Microsoft.Graph\r\n```\r\n\r\nIf you're upgrading from the preview modules, run `Install-Module` with `AllowClobber` and `Force` parameters to avoid command name conflicts:\r\n\r\n``` powershell\r\nInstall-Module Microsoft.Graph -AllowClobber -Force\r\n```\r\n\r\n## Install the Microsoft Graph Python SDK (preview)\r\n\r\n[!INCLUDE [python-sdk-preview](../../includes/python-sdk-preview.md)]\r\n\r\nThe [Microsoft Graph Python SDK (preview)](https://github.com/microsoftgraph/msgraph-sdk-python) is available on [PyPI](https://pypi.org/).\r\n\r\n```py\r\npip install msgraph-sdk\r\n```\r\n\r\n## See also\r\n\r\n- For more details about the features and capabilities of the SDK, see the SDK [design requirements documentation](https://github.com/microsoftgraph/msgraph-sdk-design).\r\n- For a list of samples for Microsoft Graph, see the [Microsoft Graph resources page](https://developer.microsoft.com/graph/gallery/?filterBy=Samples).\r\n- For step-by-step training for creating a Microsoft Graph app, see the [Microsoft Graph tutorials](/graph/tutorials).\r\n"
  },
  {
    "id": "sdks__sdks-overview",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Microsoft Graph\u00A0SDK\u00A0overview\"\r\ndescription: \"The Microsoft Graph SDK is available for the following languages: C#, PowerShell, TypeScript, JavaScript, Java, Go, PHP, and Python.\"\r\nms.localizationpriority: medium\r\nauthor: MichaelMainer\r\nms.custom: scenarios:getting-started\r\n---\r\n\r\n# Microsoft Graph SDK overview\r\n\r\nThe Microsoft Graph SDKs are designed to simplify building high-quality, efficient, and resilient applications that access Microsoft Graph. The SDKs include two components: a service library and a core library.\r\n\r\nThe *service library* contains models and request builders that are generated from Microsoft Graph metadata. The service library provides a rich, strongly-typed, and discoverable experience when working with the many datasets available in Microsoft Graph.\r\n\r\nThe *core library* provides a set of features that enhance working with all the Microsoft Graph services. Embedded support for retry handling, secure redirects, transparent authentication, and payload compression improve the quality of your application's interactions with Microsoft Graph, with no added complexity, while leaving you completely in control. The core library also provides support for common tasks such as paging through collections and creating batch requests.\r\n\r\n## Supported languages\r\n\r\nSDKs are currently available for the following languages:\r\n\r\n- [C#](https://github.com/microsoftgraph/msgraph-sdk-dotnet)\r\n- [PowerShell](https://github.com/microsoftgraph/msgraph-sdk-powershell)\r\n- [TypeScript | JavaScript](https://github.com/microsoftgraph/msgraph-sdk-javascript)\r\n- [Java](https://github.com/microsoftgraph/msgraph-sdk-java)\r\n- [Go](https://github.com/microsoftgraph/msgraph-sdk-go)\r\n- [PHP](https://github.com/microsoftgraph/msgraph-sdk-php)\r\n- [Python (preview)](https://github.com/microsoftgraph/msgraph-sdk-python)\r\n\r\n## SDKs in preview or GA status\r\n\r\nA release of an SDK can be in *preview* status upon debut or a significant update. Don't assume that a preview release will always be promoted to generally available (GA) status.\r\n\r\nIn addition, don't use a preview release of an SDK in production apps, regardless of the version of Microsoft Graph API (v1.0 or beta) it uses.\r\n\r\nA release of an SDK in *GA* status can use the Microsoft Graph API v1.0 endpoint or beta endpoint as specified. Because Microsoft Graph APIs in the beta endpoint are subject to breaking changes, don't use in production apps a GA release of an SDK that accesses the Microsoft Graph API beta endpoint.\r\n\r\n## Microsoft 365 developer subscription\r\n\r\nWhen building applications using Microsoft Graph, we recommend that you get a free Microsoft 365 developer subscription by signing up for the [Microsoft 365 Developer Program](https://developer.microsoft.com/microsoft-365/dev-program).\r\n\r\n## See also\r\n\r\n- For more information about the features and capabilities of the SDK, see [design requirements documentation](https://github.com/microsoftgraph/msgraph-sdk-design).\r\n- Request or vote on new features at the [Microsoft 365 Developer Platform ideas forum](https://techcommunity.microsoft.com/t5/microsoft-365-developer-platform/idb-p/Microsoft365DeveloperPlatform/label-name/Microsoft%20Graph).\r\n- For a list of samples for Microsoft Graph, see the [Microsoft Graph resources page](https://developer.microsoft.com/graph/gallery/?filterBy=Samples).\r\n"
  },
  {
    "id": "sdks__use-beta",
    "lastModified": "2024-03-26T06:44:31.5491359Z",
    "contents": "---\r\ntitle: \"Use the Microsoft Graph SDKs with the beta API\"\r\ndescription: \"Describes how to use the Microsoft Graph SDKs with the beta version of the API.\"\r\nms.localizationpriority: medium\r\nauthor: jasonjoh\r\n---\r\n\r\n<!-- markdownlint-disable MD051 -->\r\n\r\n# Use the Microsoft Graph SDKs with the beta API\r\n\r\nMany of the Microsoft Graph SDKs use the [v1.0](/graph/api/overview?view=graph-rest-1.0&preserve-view=false) Microsoft Graph endpoint by default. The SDKs can be used with the [beta](/graph/api/overview?view=graph-rest-beta&preserve-view=true) endpoint for nonproduction applications. The method for accessing the beta endpoint depends on which SDK you're using.\r\n\r\n[!INCLUDE [beta-disclaimer](../../api-reference/includes/beta-disclaimer.md)]\r\n\r\n## [C#](#tab/csharp)\r\n\r\nIn order to call the API, you must install the [Microsoft.Graph.Beta](https://www.nuget.org/packages/Microsoft.Graph.Beta) package. Usage is the same as the `Microsoft.Graph` package.\r\n\r\n```csharp\r\n// Version 5.x\r\nusing Microsoft.Graph.Beta;\r\n// Version 4.x and earlier\r\n// using Microsoft.Graph;\r\n\r\n// Create a new instance of GraphServiceClient.\r\nGraphServiceClient graphClient = new GraphServiceClient(...);\r\n```\r\n\r\n## [Go](#tab/go)\r\n\r\nIn order to call the API, you must install the [Microsoft Graph Beta SDK for Go](https://github.com/microsoftgraph/msgraph-beta-sdk-go) package.\r\n\r\n```go\r\nimport (\r\n    graphbeta \"github.com/microsoftgraph/msgraph-beta-sdk-go\"\r\n)\r\nclient := graphbeta.NewGraphServiceClientWithCredentials(credentials, scopes)\r\n```\r\n\r\n## [Java](#tab/java)\r\n\r\nIn order to call the API, you must install the [Microsoft Graph Beta Java SDK](https://github.com/microsoftgraph/msgraph-beta-sdk-java). Usage is the same as the non-beta SDK.\r\n\r\n```Java\r\nGraphServiceClient graphClient = GraphServiceClient\r\n    .builder()\r\n    .authenticationProvider(authProvider)\r\n    .buildClient();\r\n```\r\n\r\n## [PHP](#tab/php)\r\n\r\nThe [Microsoft Graph SDK for PHP](https://github.com/microsoftgraph/msgraph-sdk-php) supports the beta endpoint and models. You set the endpoint with the `setApiVersion` method. You need to disambiguate the v1.0 and beta models by providing an alias.\r\n\r\n```php\r\nuse Microsoft\\Graph\\Graph;\r\nuse Beta\\Microsoft\\Graph\\Model as BetaModel;\r\n\r\nclass UseBeta\r\n{\r\n    public function run()\r\n    {\r\n        $accessToken = 'xxx';\r\n\r\n        $graph = new Graph();\r\n        $graph->setAccessToken($accessToken);\r\n\r\n        $user = $graph->setApiVersion(\"beta\")\r\n                      ->createRequest(\"GET\", \"/me\")\r\n                      ->setReturnType(BetaModel\\User::class)\r\n                      ->execute();\r\n\r\n        echo \"Hello, I am $user->getGivenName() \";\r\n    }\r\n}\r\n```\r\n\r\n## [TypeScript](#tab/typescript)\r\n\r\nThe [Microsoft Graph JavaScript Client Library](https://github.com/microsoftgraph/msgraph-sdk-javascript) can call the beta API in one of two ways.\r\n\r\n- You can set the version on the `MicrosoftGraph.Client` when you create it. All requests made by the client go to the specified version.\r\n\r\n    ```typescript\r\n    const clientOptions: ClientOptions = {\r\n      defaultVersion: 'beta',\r\n      ...\r\n    };\r\n\r\n    // Initialize Graph client\r\n    const client = MicrosoftGraph.Client.initWithMiddleware(clientOptions);\r\n    ```\r\n\r\n- You can set the version on a specific request by using the `version` function on the `GraphRequest` object.\r\n\r\n    ```typescript\r\n    const user = await client\r\n      .api('/me')\r\n      .version('beta')\r\n      .get();\r\n    ```\r\n\r\n---\r\n\r\n## See also\r\n\r\n[SDKs in preview or GA status](sdks-overview.md#sdks-in-preview-or-ga-status).\r\n"
  }
]